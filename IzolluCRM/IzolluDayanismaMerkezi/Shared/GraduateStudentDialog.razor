@inject ISnackbar Snackbar

<MudDialog>
    <DialogContent>
        <MudStack Spacing="3">
            <MudAlert Severity="Severity.Info">
                Öğrenci mezun edildiğinde aktif burs durumu otomatik olarak sonlandırılacaktır.
            </MudAlert>

            <MudTextField Label="Mezuniyet Tarihi" 
                          @bind-Value="_mezuniyetTarihi" 
                          InputType="InputType.Date" 
                          Required="true" />
            
            <MudTextField Label="Meslek" 
                          @bind-Value="_meslek" 
                          Placeholder="Örn: Yazılım Geliştirici, Doktor, Öğretmen" />
            
            <MudTextField Label="Çalıştığı Firma" 
                          @bind-Value="_firma" 
                          Placeholder="Örn: ABC Yazılım A.Ş., XYZ Hastanesi" />
        </MudStack>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">İptal</MudButton>
        <MudButton Color="Color.Success" Variant="Variant.Filled" OnClick="Graduate">Mezun Et</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; } = null!;

    private string _mezuniyetTarihi = DateTime.Now.ToString("yyyy-MM-dd");
    private string _meslek = string.Empty;
    private string _firma = string.Empty;

    private async Task Graduate()
    {
        if (string.IsNullOrWhiteSpace(_mezuniyetTarihi))
        {
            Snackbar.Add("Lütfen mezuniyet tarihi seçiniz", Severity.Warning);
            return;
        }

        var result = new GraduationResult
        {
            MezuniyetTarihi = DateTime.Parse(_mezuniyetTarihi),
            Meslek = string.IsNullOrWhiteSpace(_meslek) ? null : _meslek,
            Firma = string.IsNullOrWhiteSpace(_firma) ? null : _firma
        };

        MudDialog.Close(DialogResult.Ok(result));
    }

    private void Cancel() => MudDialog.Cancel();

    public class GraduationResult
    {
        public DateTime MezuniyetTarihi { get; set; }
        public string? Meslek { get; set; }
        public string? Firma { get; set; }
    }
}
